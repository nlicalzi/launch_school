#! /usr/bin/env ruby
require "pg"

def format_row(tuple)
  features = [ tuple["id"],
               tuple["created_on"],
               tuple["amount"].rjust(12),
               tuple["memo"] ]

  puts features.join(" | ")
end

db = PG.connect(dbname: 'expenses')
result = db.exec("SELECT * FROM expenses ORDER BY created_on ASC;")

result.each do |tuple|
  format_row(tuple)
end